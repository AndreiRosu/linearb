{"version":3,"file":"gitstream-rule-parser.cjs.development.js","sources":["../src/consts.ts","../src/rules-parser/args.definitions.ts","../src/rules-parser/filters/common.ts","../src/rules-parser/filters/general-filters.ts","../src/utils/providers.ts","../src/rules-parser/filters/high-level-filters-helper.ts","../src/rules-parser/filters/filter-validators.ts","../src/rules-parser/filters/async-filter-helper.ts","../src/rules-parser/filters/explain-expert-filter-helper.ts","../src/rules-parser/filters/async-filters.ts","../src/utils/formatters.ts","../src/rules-parser/filters/integrations-filters/sonar/helpers.ts","../src/rules-parser/filters/integrations-filters/sonar/sonar.ts","../src/rules-parser/filters/integrations-filters/jit/helpers.ts","../src/rules-parser/filters/integrations-filters/jit/jit.ts","../src/rules-parser/filters/integrations-filters/jit/index.ts","../src/rules-parser/filters/high-level-filters.ts","../src/rules-parser/old-filters/filters.ts","../src/rules-parser/types.ts","../src/rules-parser/rules.parser.ts"],"sourcesContent":["export const ENVS = {\n  PROD: 'prod',\n  DEV: 'dev',\n  LOCAL: 'local',\n};\nexport const ENV = ENVS.PROD;\nexport const BASE_URL =\n  ENV === ENVS.PROD\n    ? 'https://workerb.linearb.io'\n    : ENV === ENVS.DEV\n    ? 'https://workerb.linearb-dev-03.io'\n    : 'http://localhost:3131';\nexport const API_ENDPOINTS = {\n  REVIEW_TIME: BASE_URL + '/v1/pulls/review-time',\n  EXPERT_REVIWER: BASE_URL + '/gs/v1/data-service/expert-reviewer',\n};\n\nconst PACKAGE_NAME = 'gitstream-rules-parser';\n\nexport const ERRORS = {\n  FAILED_RENDER_STRING: PACKAGE_NAME + ' - failed render string',\n  FAILED_YAML_LOAD: PACKAGE_NAME + ' - failed yaml.load',\n};\n\nexport const STATUS_CODES = {\n  FAILED_RENDER_STRING: 80,\n  FAILED_YAML_LOAD: 81,\n};\n","export const argsDefinitionsByAction = {\n  'add-comment@v1': { comment: { name: 'comment', type: 'string' } },\n  'add-label@v1': { label: { name: 'label', type: 'string' } },\n  'add-labels@v1': { labels: { name: 'labels', type: 'list' } },\n  'add-reviewers@v1': {\n    reviewers: { name: 'reviewers', type: 'list' },\n    team_reviewers: { name: 'team_reviewers', type: 'list' },\n  },\n  'merge@v1': {\n    wait_for_all_checks: { name: 'wait_for_all_checks', type: 'boolean' },\n    rebase_on_merge: { name: 'rebase_on_merge', type: 'boolean' },\n    squash_on_merge: { name: 'squash_on_merge', type: 'boolean' },\n  },\n  'require-reviewers@v1': { reviewers: { name: 'reviewers', type: 'list' } },\n  'set-required-approvals@v1': {\n    approvals: { name: 'approvals', type: 'number' },\n  },\n  'request-changes@v1': {\n    comment: { name: 'comment', type: 'number' },\n  },\n};\n\nexport const listify = [\n  argsDefinitionsByAction['add-reviewers@v1'].reviewers.name,\n  argsDefinitionsByAction['require-reviewers@v1'].reviewers.name,\n  argsDefinitionsByAction['add-reviewers@v1'].team_reviewers.name,\n  argsDefinitionsByAction['add-labels@v1'].labels.name,\n];\n","import { FiltersUsage } from './filter-types';\n\nexport const internalIncludes = (file: string, searchTerm: string) =>\n  file?.includes(searchTerm);\n\nexport const internalRegex = (\n  file: string,\n  searchTerm: string,\n  multiline: boolean = false\n) => {\n  // possible inputs are regular expressions as 'strings' or /regex/ standard javascript\n  // literals. a 3rd input is a string with a nunjuks 'r/regex/', this happens when a\n  // a nunjucks regex expression is injected back into the context.\n  // this 3rd type is non standard RegExp and therefore should inverted back.\n\n  // if it is a nunjuks regex string, convert it to compatible RegExp string\n  if (typeof searchTerm === 'string' && searchTerm.startsWith('r/')) {\n    // from the nunjuks regex patterns remove the 'r/' and the last '/'\n    searchTerm = searchTerm.substring(2).slice(0, -1);\n    // replace any \\/ back to /\n    searchTerm = searchTerm.replace('\\\\/', '/');\n  }\n\n  const re = new RegExp(searchTerm, multiline ? 'm' : '');\n  return re.test(file);\n};\n\nexport const internalEvery = (arr: boolean[], value: boolean) => {\n  const bools = arr?.map((item) => Boolean(item));\n  return bools?.length ? bools.every((element) => element === value) : false;\n};\n\nexport const formatInputToList = (input: any): any[] => {\n  if (typeof input === 'string') {\n    if (input.includes(',')) {\n      return input.split(',');\n    } else {\n      return [input];\n    }\n  }\n  return input ?? [];\n};\n\nconst PROVIDER = {\n  GITHUB: 'github',\n  GITLAB: 'gitlab',\n  BITBUCKET: 'bitbucket',\n};\n\nexport const PROVIDER_NAME: any = {\n  [PROVIDER.GITHUB]: 'GitHub',\n  [PROVIDER.GITLAB]: 'GitLab',\n  [PROVIDER.BITBUCKET]: 'BitBucket',\n};\n\nexport const DOCS_LINK_COMMENT =\n  '\\n \\nTo learn more about /:\\\\ gitStream - [Visit our Docs](https://docs.gitstream.cm/) \\n \\n';\n\nexport const MONTH: { [key: string]: string } = {\n  '01': 'JAN',\n  '02': 'FEB',\n  '03': 'MAR',\n  '04': 'APR',\n  '05': 'MAY',\n  '06': 'JUN',\n  '07': 'JUL',\n  '08': 'AUG',\n  '09': 'SEP',\n  '10': 'OCT',\n  '11': 'NOV',\n  '12': 'DEC',\n};\n\nexport class FiltersForAnalytics {\n  public static filters: FiltersUsage = {};\n}\n\nexport const handleAnalytics = (filterName: string, filterArgs: any[]) => {\n  FiltersForAnalytics.filters = {\n    ...FiltersForAnalytics.filters,\n    [filterName]: { args: filterArgs },\n  };\n};\n","import {\n  formatInputToList,\n  handleAnalytics,\n  internalEvery,\n  internalIncludes,\n  internalRegex,\n} from './common';\nimport { filterArgs } from './filter-types';\n\nconst parseSome = (list: boolean[]): boolean => {\n  handleAnalytics(GeneralFilters.some, []);\n  const formattedList = formatInputToList(list)?.map((item) => Boolean(item));\n  return (\n    Boolean(formattedList?.length) &&\n    formattedList.some((match: boolean) => match)\n  );\n};\n\nconst parseEvery = (list: boolean[]): boolean => {\n  handleAnalytics(GeneralFilters.every, []);\n  return internalEvery(formatInputToList(list), true);\n};\n\nconst termRegexOrList = (\n  file: any,\n  attribute: string,\n  term: string,\n  regex: string,\n  list: any[]\n) =>\n  term\n    ? internalIncludes(attribute ? file[attribute] : file, term)\n    : regex\n    ? internalRegex(attribute ? file[attribute] : file, regex)\n    : list.some((search) =>\n        internalIncludes(attribute ? file[attribute] : file, search)\n      );\n\nconst filterList = (\n  files: any,\n  attribute: string,\n  term: string,\n  regex: string,\n  list: any[],\n  isReject: boolean\n) => {\n  return files.filter((file: any) =>\n    isReject\n      ? !termRegexOrList(file, attribute, term, regex, list)\n      : termRegexOrList(file, attribute, term, regex, list)\n  );\n};\n\nconst mapList = (\n  files: any,\n  attribute: string,\n  term: string,\n  regex: string,\n  list: any[],\n  isReject: boolean\n) =>\n  files.map((file: any) =>\n    isReject\n      ? !termRegexOrList(file, attribute, term, regex, list)\n      : termRegexOrList(file, attribute, term, regex, list)\n  );\n\nconst calculateList = (\n  files: any[],\n  args: filterArgs,\n  callbackName: string,\n  isReject: boolean = false\n) => {\n  const attribute: string = args.attr || '';\n  const { term, regex, list } = args;\n  const formattedFiles = formatInputToList(files);\n  if (!term && !regex && !list) {\n    return [];\n  }\n  let formattedList = list;\n  if (list) {\n    formattedList = formatInputToList(list);\n  }\n  return callbackName === 'filterList'\n    ? filterList(\n        formattedFiles,\n        attribute,\n        term,\n        regex,\n        formattedList,\n        isReject\n      )\n    : mapList(formattedFiles, attribute, term, regex, formattedList, isReject);\n};\n\nconst parseFilter = (files: any[], args: filterArgs) => {\n  handleAnalytics(GeneralFilters.filter, [args]);\n  return calculateList(files, args, 'filterList');\n};\n\nconst parseReject = (files: any[], args: filterArgs) => {\n  handleAnalytics(GeneralFilters.reject, [args]);\n  return calculateList(files, args, 'filterList', true);\n};\n\nconst parseMap = (files: any[], { attr }: { attr: string }) => {\n  handleAnalytics(GeneralFilters.map, [{ attr }]);\n  return formatInputToList(files).map((file: any) => file[attr]);\n};\n\nconst parseIncludes = (file: string, args: filterArgs) => {\n  handleAnalytics(GeneralFilters.includes, [args]);\n  const { term, regex, list } = args;\n  if (!term && !regex && !list) {\n    return false;\n  }\n  let formattedList = list;\n  if (list) {\n    formattedList = formatInputToList(list);\n  }\n  return term\n    ? internalIncludes(file, term)\n    : regex\n    ? internalRegex(file, regex)\n    : formattedList.some((term: any) => file.includes(term));\n};\n\nconst parseMatch = (files: any[], args: filterArgs) => {\n  handleAnalytics(GeneralFilters.match, [args]);\n  return calculateList(files, args, 'mapList');\n};\n\nconst parseNope = (arr: boolean[]) => {\n  handleAnalytics(GeneralFilters.match, []);\n  return internalEvery(formatInputToList(arr), false);\n};\n\nexport enum GeneralFilters {\n  some = 'some',\n  every = 'every',\n  filter = 'filter',\n  includes = 'includes',\n  reject = 'reject',\n  map = 'map',\n  match = 'match',\n  nope = 'nope',\n}\n\nexport const GENERAL_FILTERS_HANDLER: any = {\n  [GeneralFilters.some]: parseSome,\n  [GeneralFilters.every]: parseEvery,\n  [GeneralFilters.filter]: parseFilter,\n  [GeneralFilters.reject]: parseReject,\n  [GeneralFilters.map]: parseMap,\n  [GeneralFilters.includes]: parseIncludes,\n  [GeneralFilters.match]: parseMatch,\n  [GeneralFilters.nope]: parseNope,\n};\n","import { ProviderFormating } from '../rules-parser/filters/filter-types';\n\nexport const ADDITIONAL_FORMATTING: ProviderFormating = {\n  github: '',\n  gitlab: '  \\n',\n  default: '',\n};\n","import { ADDITIONAL_FORMATTING } from '../../utils/providers';\nimport { DOCS_LINK_COMMENT } from './common';\nimport {\n  FileMetric,\n  Metric,\n  Activity,\n  ExplainObject,\n  rankByLinesArgs,\n} from './filter-types';\n\nconst calculateSumByAuthor = (\n  authorMetric: FileMetric,\n  author: string\n): Metric =>\n  Object.values(authorMetric).reduce((aa: Metric, item: Metric) => {\n    const precent = item[author];\n    const totalPercent = (precent ?? 0) + (aa[author] ?? 0);\n    return { ...aa, ...(totalPercent && { [author]: totalPercent }) };\n  }, {});\n\nexport const convertAndSumContributors = (\n  contributors: Metric,\n  gitToProviderUser: any\n): Metric => {\n  return Object.keys(contributors).reduce((acc: Metric, gitAuthor: string) => {\n    let score = contributors[gitAuthor];\n    if (acc[gitToProviderUser[gitAuthor]]) {\n      score = contributors[gitAuthor] + acc[gitToProviderUser[gitAuthor]];\n    }\n    const author =\n      gitToProviderUser[gitAuthor]?.includes('@') ||\n      !gitToProviderUser[gitAuthor]\n        ? gitAuthor + '\\\\*'\n        : gitToProviderUser[gitAuthor];\n    return { ...acc, [author]: score };\n  }, {});\n};\n\nexport const convertContributorsAndBlame = (repo: any) => {\n  const blame = Object.keys(repo.blame).reduce(\n    (acc: FileMetric, file: string) => {\n      return {\n        ...acc,\n        [file]: convertAndSumContributors(\n          repo.blame[file],\n          repo.git_to_provider_user\n        ),\n      };\n    },\n    {}\n  );\n  return { blame };\n};\n\nexport const sumAuthorMetrics = (\n  contributors: string[],\n  authorMetric: FileMetric\n): Metric => {\n  const numOfFiles = Object.keys(authorMetric).length;\n  return contributors.reduce((acc: Metric, author: string) => {\n    const sumByAuthor: Metric = calculateSumByAuthor(authorMetric, author);\n    return {\n      ...acc,\n      ...(sumByAuthor[author] && {\n        [author]: sumByAuthor[author] / numOfFiles,\n      }),\n    };\n  }, {});\n};\n\nexport const convertToProviderUser = (repo: any, gitObject: Metric) =>\n  Object.keys(gitObject).reduce((acc: Metric, gitAuthor: string) => {\n    if (repo.git_to_provider_user[gitAuthor]) {\n      return {\n        ...acc,\n        [repo.git_to_provider_user[gitAuthor]]:\n          gitObject[gitAuthor] || gitAuthor,\n      };\n    }\n    return acc;\n  }, {});\n\nexport const calculateActivityPerFile = (\n  activity: Activity,\n  weeksArr: string[]\n): FileMetric =>\n  Object.keys(activity).reduce((acc, file) => {\n    const totalPerFile = Object.values(activity[file]).reduce(\n      (ac: Metric, linesPerWeek: Metric) => {\n        weeksArr.forEach((week) => {\n          const item = linesPerWeek[week];\n          if (item) {\n            ac[week] = (ac[week] ?? 0) + item;\n          }\n        });\n        return { ...ac };\n      },\n      {}\n    );\n    return { ...acc, [file]: totalPerFile };\n  }, {});\n\nexport const calculateFileSumPerAuthorActivity = (\n  activity: Activity,\n  weeksArr: string[],\n  totalsPerFile: FileMetric\n): FileMetric =>\n  Object.keys(activity).reduce((acc: FileMetric, file: string) => {\n    const calcPercent: Metric = Object.keys(activity[file]).reduce(\n      (acAuthor: Metric, author: string) => {\n        let arrSum: number[] = [];\n        weeksArr.forEach((week: string) => {\n          if (totalsPerFile[file][week] && activity[file][author][week]) {\n            arrSum.push(\n              (activity[file][author][week] / totalsPerFile[file][week]) * 100\n            );\n          }\n        });\n        const total: number =\n          arrSum.reduce((a: number, b: number) => a + b, 0) / arrSum.length;\n        return {\n          ...acAuthor,\n          ...(arrSum.length && { [author]: parseInt(total?.toFixed(0)) }),\n        };\n      },\n      {}\n    );\n    return { ...acc, [file]: calcPercent };\n  }, {});\n\nexport const sortObject = (data: any[], object: any) =>\n  data.sort((a: any, b: any) => (object[b] ?? 0) - (object[a] ?? 0));\n\nconst compareThan = (data: Metric, gt: number, lt: number) => {\n  const authors = Object.keys(data).filter((author: string) =>\n    gt !== undefined ? data[author] > gt : data[author] < lt\n  );\n  const sortedAuthors = sortObject(authors, data);\n\n  return sortedAuthors.reduce((acc: any, author: string) => {\n    if (author.includes('*')) {\n      return acc;\n    }\n    return { ...acc, ...{ [author]: data[author] } };\n  }, {});\n};\n\nexport const validateAndCompare = (\n  authorMetrics: Metric,\n  gt: number,\n  lt: number\n): Metric | {} =>\n  Object.keys(authorMetrics).length ? compareThan(authorMetrics, gt, lt) : {};\n\nexport const convertBlameContextToExplain = (repo: any) => {\n  const { blame } = convertContributorsAndBlame(repo);\n  return Object.keys(blame).reduce((acc: any, file: string) => {\n    if (file === '/dev/null') {\n      return acc;\n    }\n    const sortedAuthors = sortObject(Object.keys(blame[file]), blame[file]);\n    const formattedValues = sortedAuthors.reduce(\n      (accAuthor: ExplainObject, author) => {\n        if (!blame[file][author]) {\n          return accAuthor;\n        }\n        const formatGitAuthor = author.replace(/\\\"\\“/g, '').replace('“', '');\n        let formattedValue = `${\n          Math.floor(blame[file][author])\n            ? Math.floor(blame[file][author])\n            : '<1'\n        }%`;\n        if (\n          accAuthor[formatGitAuthor] &&\n          parseInt(accAuthor[formatGitAuthor]) > parseInt(formattedValue)\n        ) {\n          formattedValue = accAuthor[formatGitAuthor];\n        }\n        return { ...accAuthor, [formatGitAuthor]: formattedValue };\n      },\n      {}\n    );\n    return { ...acc, [file]: formattedValues };\n  }, {});\n};\n\nconst suggestedReviewersComment = (\n  authorFilteredParseResult: string,\n  argsTemplate: string,\n  numOfPRFiles: number,\n  isNoUserButYou: boolean\n) => {\n  const formattedComment = authorFilteredParseResult\n    ? ` 👋  **Suggested reviewers: ${authorFilteredParseResult}**\\n \\nThey contributed ${argsTemplate} of the lines on pre-existing files`\n    : ` 👋  **Suggested reviewers: no user ${\n        isNoUserButYou ? 'but you' : ''\n      } matched**\\n \\nNo ${\n        numOfPRFiles ? 'other ' : ''\n      }user contributed ${argsTemplate} of the lines on pre-existing files`;\n  return formattedComment;\n};\n\nexport const explainBlameTemplate = (\n  args: rankByLinesArgs,\n  authorFilteredParseResult: string,\n  formattedBlameContext: any,\n  provider: string,\n  isNoUserButYou: boolean\n) => {\n  const { gt, lt } = args;\n  const argsTemplate = gt ? `more than ${gt}%` : `less than ${lt}%`;\n\n  const numOfPRFiles = Object.keys(formattedBlameContext).length;\n  let parserResultTemplate = suggestedReviewersComment(\n    authorFilteredParseResult,\n    argsTemplate,\n    numOfPRFiles,\n    isNoUserButYou\n  );\n  parserResultTemplate += numOfPRFiles ? ':\\n' : '. \\n ';\n  parserResultTemplate += Object.keys(formattedBlameContext).length\n    ? '<details>\\n <summary>See details</summary>\\n'\n    : '';\n  parserResultTemplate += '\\n';\n  Object.keys(formattedBlameContext).forEach((file) => {\n    if (Object.keys(formattedBlameContext[file]).length === 0) {\n      return;\n    }\n    parserResultTemplate += `\\n\\`${file}\\` \\n${\n      ADDITIONAL_FORMATTING[provider] || ADDITIONAL_FORMATTING.default\n    }`; //Supporting new lines format for gitlab\n    Object.keys(formattedBlameContext[file]).forEach((author) => {\n      parserResultTemplate += `${author}: ${\n        formattedBlameContext[file][author]\n      } \\n${ADDITIONAL_FORMATTING[provider] || ADDITIONAL_FORMATTING.default}`; //Supporting new lines format for gitlab\n    });\n  });\n  parserResultTemplate += '\\n</details>\\n';\n  const isGitUser = Object.values(formattedBlameContext)\n    .map((item: any) => Object.keys(item).some((x) => x.includes('*')))\n    .some((result) => result);\n\n  parserResultTemplate += isGitUser\n    ? ` \\nGit users that could not be automatically mapped are marked with \\`*\\`.\\n${\n        ADDITIONAL_FORMATTING[provider] || ADDITIONAL_FORMATTING.default\n      }To map these users, refer to the instructions [here](https://docs.gitstream.cm/cm-file#config).\\n \\n`\n    : ''; //Supporting new lines format for gitlab\n  parserResultTemplate += DOCS_LINK_COMMENT;\n  return parserResultTemplate;\n};\n","import { rankByLinesArgs } from './filter-types';\n\nexport const isGtLtArgsValid = (args: rankByLinesArgs) => {\n  const { gt, lt } = args;\n  return !!gt || !!lt;\n};\n","import axios from 'axios';\nimport { API_ENDPOINTS } from '../../consts';\nimport { rankByLinesArgs } from './filter-types';\n\n//TODO: map request to object\nexport const getETR = async (request: any) => {\n  const {\n    data: { numericValue },\n  } = await axios.post(API_ENDPOINTS.REVIEW_TIME, request, {\n    headers: {\n      'Content-type': 'application/json',\n    },\n  });\n  return { numericValue };\n};\n\n//TODO: map request to object\nexport const getExpertReviewer = async (request: any) => {\n  if (request) {\n    const { data } = await axios.post(API_ENDPOINTS.EXPERT_REVIWER, request, {\n      headers: {\n        'Content-type': 'application/json',\n      },\n    });\n    return data || {};\n  }\n  return {};\n};\n\nexport const filterExpertResult = (\n  data: any,\n  gt: number,\n  lt: number,\n  filterBy: string\n) => {\n  const thresholdData = Object.keys(data).reduce((acc, user) => {\n    if (\n      gt !== undefined\n        ? data[user][filterBy] > gt / 100\n        : data[user][filterBy] < lt / 100\n    ) {\n      return { ...acc, [user]: data[user] };\n    }\n    return acc;\n  }, {});\n\n  return (\n    Object.keys(thresholdData).filter(\n      (contributor) => !contributor.includes('@') && !contributor.includes('<>')\n    ) || []\n  );\n};\n\nexport const parseExpertReviewerThreshold = (args: rankByLinesArgs): number => {\n  const { gt, lt } = args;\n  return gt ? gt : lt ? lt : 0.1;\n};\n\nexport const getAndFilterExpertReviewer = async (repo: any) => {\n  const data = await getExpertReviewer(\n    repo.data_service?.expert_reviwer_request\n  );\n  if (!Object.keys(data).length) {\n    return { data: {}, dataWithoutIssuer: {}, isIssuerFiltered: false };\n  }\n\n  let isIssuerFiltered = false;\n  const dataWithoutIssuer = Object.keys(data).reduce((acc, author) => {\n    if (author === repo.pr_author) {\n      isIssuerFiltered = true;\n      return acc;\n    }\n    return { ...acc, [author]: data[author] };\n  }, {});\n  return { data, dataWithoutIssuer, isIssuerFiltered };\n};\n","import { MONTH } from './common';\nimport moment from 'moment';\nimport { ActivityExplain, FileMetric } from './filter-types';\nimport { sortObject } from './high-level-filters-helper';\nimport { ADDITIONAL_FORMATTING } from '../../utils/providers';\n\nexport const explainExpertReviewerComment = (\n  expertReviewers: string[],\n  activeUsers: string[],\n  knowledgeUsers: string[],\n  threshold: number,\n  provider: string,\n  isNoUserButYou: boolean\n) => {\n  let comment = '🥷 **Code experts:';\n  comment += expertReviewers.length\n    ? ` ${expertReviewers.join(', ')}** \\n \\n`\n    : ` no user ${\n        isNoUserButYou ? 'but you' : ''\n      } matched threshold ${threshold}** \\n \\n`;\n\n  if (activeUsers.length) {\n    comment += `${activeUsers.join(', ')} ${\n      activeUsers.length === 1 ? 'has' : 'have'\n    } most 👩‍💻 **activity** in the files. \\n${\n      ADDITIONAL_FORMATTING[provider] || ADDITIONAL_FORMATTING.default\n    }`;\n  }\n  if (knowledgeUsers.length) {\n    comment += `${knowledgeUsers.join(', ')} ${\n      knowledgeUsers.length === 1 ? 'has' : 'have'\n    } most 🧠 **knowledge** in the files. \\n`;\n  }\n  return comment;\n};\n\nconst explainActivityByMonth = (\n  activity: any,\n  file: string,\n  activityUsers: string[]\n) => {\n  let monthsComment = '';\n  const months: string[] = [];\n  for (let index = 0; index < 6; index++) {\n    months.push(MONTH[moment().subtract(index, 'months').format('MM')]);\n  }\n  months.forEach((month) => {\n    const user1Value = activity[file][activityUsers[0]][month];\n    const user2Value = activity[file][activityUsers[1]]?.[month];\n    monthsComment += `| ${month} | ${\n      user1Value\n        ? user1Value.additions +\n          ' additions & ' +\n          user1Value.deletions +\n          ' deletions'\n        : ' '\n    } |`;\n    monthsComment += `${\n      user2Value\n        ? user2Value.additions +\n          ' additions & ' +\n          user2Value.deletions +\n          ' deletions |'\n        : ' '\n    } \\n`;\n  });\n  return monthsComment;\n};\n\nconst explainActivityTable = (\n  file: string,\n  activity: any,\n  activityUsers: string[]\n) => {\n  if (!Object.keys(activity).length) {\n    return '\\n\\nNo activity in the last 6 months\\n\\n'; // can be extract to const NO_ACTIVITY_MESSAGE\n  }\n  if (activityUsers.length) {\n    let table = `\\n\\nActivity based on git-commit: \\n\\n |  | ${\n      activityUsers[0] ? activityUsers[0] : ' '\n    } | ${\n      activityUsers[1]\n        ? activityUsers[1] + '| \\n | --- | --- | --- | \\n '\n        : ' \\n | --- | --- | \\n'\n    }`;\n    table += explainActivityByMonth(activity, file, activityUsers);\n    return table;\n  }\n  return '';\n};\n\nconst explainKnowledgeSection = (\n  file: string,\n  knowledge: any,\n  knowledgeUsers: string[],\n  provider: string\n) => {\n  let knowledgeText = '';\n  const sortedAuthors = sortObject(knowledgeUsers, knowledge[file]);\n  sortedAuthors.forEach((author) => {\n    knowledgeText += knowledge[file][author]\n      ? `${author}: ${knowledge[file][author]}% \\n${\n          ADDITIONAL_FORMATTING[provider] || ADDITIONAL_FORMATTING.default\n        }`\n      : '';\n  });\n  return knowledgeText;\n};\n\nexport const explainActivityAndBlameComment = (\n  files: string[],\n  activity: any,\n  knowledge: any,\n  activityUsers: string[],\n  knowledgeUsers: string[],\n  provider: string\n) => {\n  try {\n    let comment = '<details>\\n <summary>See details</summary>\\n\\n';\n    files.forEach((file) => {\n      comment += `\\n\\`${file}\\` \\n ${explainActivityTable(\n        file,\n        activity,\n        activityUsers\n      )} \\n\\nKnowledge based on git-blame: \\n ${\n        ADDITIONAL_FORMATTING[provider] || ADDITIONAL_FORMATTING.default\n      }${explainKnowledgeSection(file, knowledge, knowledgeUsers, provider)}`;\n    });\n    comment += `\\n</details>\\n`;\n    return comment;\n  } catch (error) {\n    console.log('Error in creating explain code experts comment', error);\n    return '';\n  }\n};\n\nconst parseActivityByUserDataForExplain = (\n  activity: any,\n  file: string,\n  user: string\n) => {\n  return Object.keys(activity[file]).reduce((ac, date) => {\n    if (activity[file][date][user]) {\n      const formatedDate: string = MONTH[date.split('-')?.[1]];\n      return {\n        ...ac,\n        [formatedDate]: activity[file][date][user],\n      };\n    }\n    return ac;\n  }, {});\n};\nconst parseActivityByUserForExplain = (\n  activity: any,\n  file: string,\n  activeUsers: string[]\n) => {\n  return activeUsers.reduce((au, user) => {\n    const activityData = parseActivityByUserDataForExplain(\n      activity,\n      file,\n      user\n    );\n    return { ...au, [user]: activityData };\n  }, {});\n};\n\nexport const getExplainActivity = (\n  activity: ActivityExplain,\n  activeUsers: string[]\n) => {\n  return Object.keys(activity || {}).reduce((acc, file) => {\n    const userActivity = parseActivityByUserForExplain(\n      activity,\n      file,\n      activeUsers\n    );\n    return { ...acc, [file]: userActivity };\n  }, {});\n};\n\nexport const getExplainKnowledge = (\n  blame: FileMetric,\n  knowledgeUsers: string[]\n) => {\n  return Object.keys(blame || {}).reduce((acc, file) => {\n    const sortedAuthors = sortObject(knowledgeUsers, blame[file]);\n    const userKnowledge = sortedAuthors.reduce((au, user) => {\n      if (blame[file][user]) {\n        return {\n          ...au,\n          [user]: Math.round(blame[file][user] * 100),\n        };\n      }\n      return au;\n    }, {});\n    return { ...acc, [file]: userKnowledge };\n  }, {});\n};\n","import { rankByLinesArgs } from './filter-types';\nimport { FileMetadata } from '../context/types';\nimport {\n  filterExpertResult,\n  getAndFilterExpertReviewer,\n  getETR,\n  parseExpertReviewerThreshold,\n} from './async-filter-helper';\nimport { DOCS_LINK_COMMENT, handleAnalytics } from './common';\nimport {\n  explainActivityAndBlameComment,\n  explainExpertReviewerComment,\n  getExplainActivity,\n  getExplainKnowledge,\n} from './explain-expert-filter-helper';\nimport { HighLevelFilters } from './high-level-filters';\n\nconst DELETED_PATH = '/dev/null';\n\nexport const estimatedReviewTime = async (branch: any, callback: any) => {\n  handleAnalytics(HighLevelFilters.estimatedReviewTime, []);\n  const numOfFiles = branch.diff?.files_metadata.length;\n  const { additionalLines, deletedLines } = branch.diff?.files_metadata.reduce(\n    (acc: any, file: FileMetadata) => {\n      acc.additionalLines += file.additions;\n      acc.deletedLines += file.deletions;\n      return acc;\n    },\n    { additionalLines: 0, deletedLines: 0 }\n  );\n  const prFiles = branch.diff?.files_metadata.map(\n    (fileMetadata: FileMetadata) => ({\n      file_path:\n        fileMetadata.new_file !== DELETED_PATH\n          ? fileMetadata.new_file\n          : fileMetadata.original_file,\n      additions: fileMetadata.additions,\n      deletions: fileMetadata.deletions,\n    })\n  );\n  const reqBody = {\n    prMetadata: {\n      commits: branch.num_of_commits,\n      files: numOfFiles,\n      lines: additionalLines + deletedLines,\n    },\n    prFiles: prFiles,\n    prAdditionalLines: additionalLines,\n    prDeletedLines: deletedLines,\n    baseBranch: branch.base,\n    request_source: 'gitstream',\n  };\n\n  const { numericValue } = await getETR(reqBody);\n  callback(null, numericValue);\n};\n\nexport const parseExpertReviewer = async (\n  repo: any,\n  { gt = 0, lt = 0 }: rankByLinesArgs,\n  callback: any\n) => {\n  try {\n    handleAnalytics(HighLevelFilters.expertReviewer, [{ gt, lt }]);\n    const { dataWithoutIssuer } = await getAndFilterExpertReviewer(repo);\n    if (!Object.keys(dataWithoutIssuer).length) {\n      callback(null, []);\n    }\n\n    const expertReviewers = filterExpertResult(\n      dataWithoutIssuer,\n      gt,\n      lt,\n      'reviewer_score'\n    ).slice(0, 2);\n    callback(null, expertReviewers);\n  } catch (error) {\n    console.log('error:', error);\n    callback(null, []);\n  }\n};\n\nexport const parseExplainCodeExpertHandler = async (\n  repo: any,\n  args: rankByLinesArgs,\n  callback: any\n) => {\n  try {\n    const { gt, lt } = args;\n    const { data, dataWithoutIssuer, isIssuerFiltered } =\n      await getAndFilterExpertReviewer(repo);\n    if (!Object.keys(data).length || !Object.keys(dataWithoutIssuer).length) {\n      callback(null, []);\n    }\n    const expertReviewers = filterExpertResult(\n      dataWithoutIssuer,\n      gt,\n      lt,\n      'reviewer_score'\n    ).slice(0, 2);\n    const activeUsers = filterExpertResult(\n      data,\n      gt,\n      lt,\n      'avg_activity_score'\n    ).slice(0, 2);\n    const knowledgeUsers = filterExpertResult(\n      data,\n      gt,\n      lt,\n      'avg_blame_perc'\n    ).slice(0, 2);\n\n    const explainActivity = getExplainActivity(\n      data.explain?.activity,\n      activeUsers\n    );\n\n    const explainKnowledge = getExplainKnowledge(\n      data.explain?.blame,\n      knowledgeUsers\n    );\n\n    const explainComment = `${explainExpertReviewerComment(\n      expertReviewers,\n      activeUsers,\n      knowledgeUsers,\n      parseExpertReviewerThreshold(args),\n      repo.provider,\n      isIssuerFiltered && !Object.keys(expertReviewers).length\n    )} ${explainActivityAndBlameComment(\n      Array.from(\n        new Set([\n          ...Object.keys(explainActivity),\n          ...Object.keys(explainKnowledge),\n        ])\n      ),\n      explainActivity,\n      explainKnowledge,\n      activeUsers,\n      knowledgeUsers,\n      repo.provider\n    )} \\n\\n ${DOCS_LINK_COMMENT} \\n`;\n\n    const base64Comment = `base64: ${Buffer.from(explainComment).toString(\n      'base64'\n    )}`;\n\n    callback(null, base64Comment);\n  } catch (error) {\n    console.log('error:', error);\n    callback(``);\n  }\n};\n\nexport const parseCodeExperts = async (\n  repo: any,\n  { gt = 0, lt = 0 }: rankByLinesArgs,\n  callback: any\n) => {\n  handleAnalytics(HighLevelFilters.codeExperts, [{ gt, lt }]);\n  await parseExpertReviewer(repo, { gt, lt }, callback);\n};\n\nexport const parseExplainExpertReviewer = async (\n  repo: any,\n  args: rankByLinesArgs,\n  callback: any\n) => {\n  handleAnalytics(HighLevelFilters.explainExpertReviewer, [args]);\n  await parseExplainCodeExpertHandler(repo, args, callback);\n};\n\nexport const parseExplainCodeExperts = async (\n  repo: any,\n  args: rankByLinesArgs,\n  callback: any\n) => {\n  handleAnalytics(HighLevelFilters.explainCodeExperts, [args]);\n  await parseExplainCodeExpertHandler(repo, args, callback);\n};\n","import _ from 'lodash';\nimport prettier from 'prettier';\nimport { spawnSync } from 'child_process';\n\nconst PYTHON_COMMAND = 'python';\n\nexport const minify = (text: string) =>\n  text.replace(/\\s+/g, ' ').replaceAll(\"'\", '\"').trim();\n\nexport const removeEmptyLines = (text: string) =>\n  text.replace(/^\\s*[\\r\\n]/gm, '');\n\nexport const jsFormatter = (content: string, file: string) => {\n  return minify(\n    prettier.format(content, {\n      semi: false,\n      singleQuote: true,\n      filepath: file,\n    })\n  );\n};\nexport const pyFormatter = (content: string) => {\n  // Format the code with black\n  const blackResult = spawnSync(PYTHON_COMMAND, [\n    '-c',\n    `import black; print(black.format_str(${JSON.stringify(\n      content\n    )}, mode=black.FileMode()))`,\n  ]);\n  const formattedCode = blackResult.stdout.toString();\n  return removeEmptyLines(formattedCode);\n};\n\nconst SUPPORTED_FORMATTERS = {\n  js: jsFormatter,\n  ts: jsFormatter,\n  html: jsFormatter,\n  py: pyFormatter,\n  default: minify,\n};\nexport const format = (content: string, file: string) => {\n  const fileExtension = file.split('.').pop() ?? '';\n  const formatter = _.get(\n    SUPPORTED_FORMATTERS,\n    fileExtension,\n    SUPPORTED_FORMATTERS.default\n  );\n  return formatter(content, file);\n};\n","export const SONAR_REGEX = {\n  BUGS: /\\[\\d+ Bugs?\\]/g,\n  VULNERABILITIES: /\\[\\d+ Vulnerabilit(?:ies|y)\\]/g,\n  SECURITY_HOTSPOTS: /\\[\\d+ Security Hotspots?\\]/g,\n  CODE_SMELL: /\\[\\d+ Code Smells?\\]/g,\n  DUPLICATIONS: /\\[(\\d+(\\.\\d+)?|\\.\\d+)%\\]/g,\n  COVERAGE: /\\[(\\d+(\\.\\d+)?|\\.\\d+)%\\]/g,\n  RATING: /!\\[([A-Z])\\]/g,\n};\n\nexport const getSonarPropertyRating = (str: string): string => {\n  const rawRating = str.match(SONAR_REGEX.RATING)?.[0];\n  const rating = rawRating?.substring(\n    rawRating.lastIndexOf('[') + 1,\n    rawRating.indexOf(']')\n  );\n  return rating ? rating : '';\n};\n\nexport const getSonarPropertyCount = (\n  row: string,\n  regex: any,\n  isFloat: boolean = false\n): number | null => {\n  const count =\n    (isFloat\n      ? parseFloat(row.match(regex)?.[0].split(/\\s+/)[0].replace('[', '') || '')\n      : parseInt(\n          row.match(regex)?.[0].split(/\\s+/)[0].replace('[', '') || ''\n        )) ?? null;\n  return isNaN(count) ? null : count;\n};\n","import { Sonar } from './types';\nimport {\n  SONAR_REGEX,\n  getSonarPropertyCount,\n  getSonarPropertyRating,\n} from './helpers';\nimport { handleAnalytics } from '../../common';\nimport { HighLevelFilters } from '../../high-level-filters';\n\nexport const parseSonarParser = (pr: any): string => {\n  handleAnalytics(HighLevelFilters.sonarParser, []);\n  let sonarObject: Sonar = {\n    bugs: { count: null, rating: '' },\n    code_smells: { count: null, rating: '' },\n    vulnerabilities: { count: null, rating: '' },\n    security_hotspots: { count: null, rating: '' },\n    duplications: null,\n    coverage: null,\n  };\n  const sonarComment = pr.comments.filter(\n    (comment: any) => comment.commenter === 'sonarcloud'\n  );\n  if (sonarComment.length) {\n    const sonarCommentArray = sonarComment[0].content.split('\\n');\n    sonarObject.bugs = {\n      count: getSonarPropertyCount(sonarCommentArray[2], SONAR_REGEX.BUGS),\n      rating: getSonarPropertyRating(sonarCommentArray[2]),\n    };\n    sonarObject.code_smells = {\n      count: getSonarPropertyCount(\n        sonarCommentArray[5],\n        SONAR_REGEX.CODE_SMELL\n      ),\n      rating: getSonarPropertyRating(sonarCommentArray[5]),\n    };\n\n    sonarObject.vulnerabilities = {\n      count: getSonarPropertyCount(\n        sonarCommentArray[3],\n        SONAR_REGEX.VULNERABILITIES\n      ),\n      rating: getSonarPropertyRating(sonarCommentArray[3]),\n    };\n\n    sonarObject.security_hotspots = {\n      count: getSonarPropertyCount(\n        sonarCommentArray[4],\n        SONAR_REGEX.SECURITY_HOTSPOTS\n      ),\n      rating: getSonarPropertyRating(sonarCommentArray[4]),\n    };\n    sonarObject.duplications = getSonarPropertyCount(\n      sonarCommentArray[8],\n      SONAR_REGEX.DUPLICATIONS,\n      true\n    );\n    sonarObject.coverage = getSonarPropertyCount(\n      sonarCommentArray[7],\n      SONAR_REGEX.COVERAGE,\n      true\n    );\n  }\n\n  return JSON.stringify(sonarObject);\n};\n","import _ from 'lodash';\nimport { Jit, Severity } from './types';\nimport { IPRContext } from '../../../context/types';\n\nconst JIT_USER = 'jit-ci';\n\nexport const parseJitReview = (review: any): Jit => {\n  const parsedReview: Jit = initEmptyJitObject();\n  const conversations = review.conversations;\n  conversations.forEach((conversation: any) => {\n    const content = conversation.content;\n    const lines = content.split('\\n');\n    const security_control = lines[0]?.split('**')[2]?.trim();\n    const type = lines[2]?.split('**')[2]?.trim();\n    const description = lines[4]?.split('**')[2]?.trim();\n    const severity: Severity = lines[6]?.split('**')[2]?.trim();\n    const _summary =\n      lines[10]?.split('<summary>')[1]?.split('</summary>')[0] ?? '';\n    const summary = _summary.replace(/<b>/g, '').replace(/<\\/b>/g, '');\n    parsedReview.vulnerabilities.push({\n      security_control,\n      type,\n      description,\n      severity,\n      summary,\n    });\n    parsedReview.metrics[severity] = (parsedReview.metrics[severity] ?? 0) + 1;\n  });\n  return parsedReview;\n};\n\nexport const unifyReviews = (parsedReviews: Jit[], jitObject: Jit) => {\n  return parsedReviews.reduce(\n    (acc: any, review: any) => {\n      console.log({ acc, review });\n      return {\n        ...acc,\n        vulnerabilities: [...acc.vulnerabilities, ...review.vulnerabilities],\n        metrics: _.mergeWith(\n          acc.metrics,\n          review.metrics,\n          (a, b) => (a || 0) + (b || 0)\n        ),\n      };\n    },\n    { ...jitObject }\n  );\n};\n\nexport const extractJitCommentsFromPR = (pr: IPRContext) => {\n  return pr.reviews.filter(\n    ({ commenter }: { commenter: string }) => commenter === JIT_USER\n  );\n};\n\nexport const initEmptyJitObject = () => {\n  return {\n    vulnerabilities: [],\n    metrics: {\n      HIGH: null,\n      MEDIUM: null,\n      LOW: null,\n      INFO: null,\n    },\n  };\n};\n","import { IPRContext } from '../../../context/types';\nimport { handleAnalytics } from '../../common';\nimport { HighLevelFilters } from '../../high-level-filters';\nimport {\n  extractJitCommentsFromPR,\n  initEmptyJitObject,\n  parseJitReview,\n  unifyReviews,\n} from './helpers';\nimport _ from 'lodash';\n\nexport const parseJitComments = (pr: IPRContext): string => {\n  handleAnalytics(HighLevelFilters.extractJitFindings, []);\n  const jitComments = extractJitCommentsFromPR(pr);\n  const jitObject = initEmptyJitObject();\n  if (_.isEmpty(jitComments)) {\n    return JSON.stringify(jitObject);\n  }\n  const parsedReviews = jitComments.map(parseJitReview);\n  return JSON.stringify(unifyReviews(parsedReviews, jitObject));\n};\n","import { parseJitComments } from './jit';\nexport default { extractJitFindings: parseJitComments };\n","import { File } from '../context/types';\nimport { handleAnalytics, internalRegex } from './common';\nimport {\n  Metric,\n  matchDiffLinesArgs,\n  rankByGitActivityArgs,\n  rankByLinesArgs,\n  FileMetric,\n  EnumArgs,\n} from './filter-types';\nimport _ from 'lodash';\nimport {\n  calculateFileSumPerAuthorActivity,\n  calculateActivityPerFile,\n  sumAuthorMetrics,\n  validateAndCompare,\n  convertBlameContextToExplain,\n  explainBlameTemplate,\n  convertContributorsAndBlame,\n  convertAndSumContributors,\n} from './high-level-filters-helper';\nimport { isGtLtArgsValid } from './filter-validators';\nimport {\n  estimatedReviewTime,\n  parseCodeExperts,\n  parseExpertReviewer,\n  parseExplainCodeExperts,\n  parseExplainExpertReviewer,\n} from './async-filters';\nimport { format } from '../../utils/formatters';\nimport parseSonarParser from './integrations-filters/sonar';\nimport jitFilter from './integrations-filters/jit';\n\nconst parseExtractSonarFindings = (pr: any): string => {\n  handleAnalytics(HighLevelFilters.extractSonarFindings, []);\n  return parseSonarParser(pr);\n};\n\nconst parserMapToEnum = (key: string, args: EnumArgs) => {\n  handleAnalytics(HighLevelFilters.mapToEnum, [key, args]);\n  const enumArgs = args?.enum;\n  if (enumArgs && Object.keys(enumArgs).length) {\n    return enumArgs[key];\n  }\n};\n\nconst parseFilterAllTests = (files: string[], extensions: string[]) => {\n  const regex = new RegExp(`[^a-zA-Z0-9](${extensions.join('|')})[^a-zA-Z0-9]`);\n  return (\n    Boolean(files.length) &&\n    files\n      .map((filePath: string) => regex.test(filePath || ''))\n      .every((x: boolean) => x)\n  );\n};\n\nconst parseFilterAllFilePath = (files: string[], searchArray: string[]) =>\n  Boolean(files.length) &&\n  files\n    .map((filePath: string) =>\n      searchArray.some((term: string) => (filePath || '').includes(term))\n    )\n    .every((x: boolean) => x);\n\nconst parseFilterAllExtensions = (files: string[], extensions: string[]) =>\n  files.length\n    ? parseFilterAllFilePath(\n        files.map((filePath: string) => filePath.split('.').pop() || ''),\n        extensions\n      )\n    : false;\n\nconst getUniqueExtensions = (files: string[]) => {\n  handleAnalytics(HighLevelFilters.extensions, []);\n  return (\n    files\n      // extensions\n      .map((x: string) => x.split('.').pop())\n      // unique\n      .filter((value, index, array) => array.indexOf(value) === index)\n  );\n};\n\nconst parseIsFormattingChange = (files: File[]) => {\n  try {\n    handleAnalytics(HighLevelFilters.isFormattingChange, []);\n    const allFormatting =\n      Boolean(files.length) &&\n      files.every(\n        ({ new_content, original_content, original_file, new_file }) => {\n          const formattedNew = format(new_content, new_file);\n          const formattedOld = format(original_content, original_file);\n          return formattedNew === formattedOld;\n        }\n      );\n    return allFormatting;\n  } catch (e) {\n    return false;\n  }\n};\n\nconst parseMatchDiffLines = (files: File[], args: matchDiffLinesArgs) => {\n  handleAnalytics(HighLevelFilters.matchDiffLines, [args]);\n  const { regex, ignoreWhiteSpaces } = args;\n  const diffLinesRegex = new RegExp('^[+-]');\n  const emptyLinesRegex = new RegExp('^[+-]\\\\s*$');\n  return !regex\n    ? []\n    : files\n        .map(({ diff }) =>\n          diff\n            .split('\\n')\n            .filter((row) => diffLinesRegex.test(row))\n            .filter((row) =>\n              ignoreWhiteSpaces ? !emptyLinesRegex.test(row) : true\n            )\n            .map((diffRow) => internalRegex(diffRow, regex))\n        )\n        .flat(1);\n};\n\nconst parseIsFirstCommit = (contributors: any, author: string) => {\n  handleAnalytics(HighLevelFilters.isFirstCommit, [{ author }]);\n  return _.get(contributors, author, null) ? false : true;\n};\n\nconst parseRankByGitBlame = (repo: any, args: rankByLinesArgs) => {\n  handleAnalytics(HighLevelFilters.rankByGitBlame, [args]);\n  if (!isGtLtArgsValid(args)) {\n    return [];\n  }\n  const { gt, lt } = args;\n  const { blame } = convertContributorsAndBlame(repo);\n  const blameByAuthor = sumAuthorMetrics(\n    Object.values(repo.git_to_provider_user),\n    blame\n  );\n  const comparedResult = validateAndCompare(blameByAuthor, gt, lt);\n  return Object.keys(comparedResult).length\n    ? [...Array.from(new Set(Object.keys(comparedResult)))]\n    : [];\n};\n\nconst parseRankByGitActivity = (repo: any, args: rankByGitActivityArgs) => {\n  handleAnalytics(HighLevelFilters.rankByGitActivity, [args]);\n  const { gt, lt, weeks } = args;\n  if ((!gt && !lt) || !weeks) {\n    return [];\n  }\n  const weeksArr: string[] = new Array(weeks + 1)\n    .fill(0)\n    .map((_, i) => `week_${i}`);\n\n  const totalsPerFile: FileMetric = calculateActivityPerFile(\n    repo.git_activity,\n    weeksArr\n  );\n  const fileSumPerAuthor: FileMetric = calculateFileSumPerAuthorActivity(\n    repo.git_activity,\n    weeksArr,\n    totalsPerFile\n  );\n  const activityByAuthor: Metric = sumAuthorMetrics(\n    Object.keys(repo.contributors),\n    fileSumPerAuthor\n  );\n  const convertContributors = convertAndSumContributors(\n    activityByAuthor,\n    repo.git_to_provider_user\n  );\n  const comparedResult: Metric = validateAndCompare(\n    convertContributors,\n    gt,\n    lt\n  );\n\n  return Object.keys(comparedResult).length\n    ? [...Array.from(new Set(Object.keys(comparedResult)))]\n    : [];\n};\n\nconst parseExplainRankByGitBlame = (repo: any, args: rankByLinesArgs) => {\n  handleAnalytics(HighLevelFilters.explainRankByGitBlame, [args]);\n  if (!isGtLtArgsValid(args)) {\n    return {};\n  }\n  const parseResult = parseRankByGitBlame(repo, args);\n  const authorFilteredParseResult = _.filter(\n    parseResult,\n    (contributor) => contributor !== repo.pr_author\n  );\n  const authorFilteredParseResultString = authorFilteredParseResult.join(', ');\n  const isNoUserButYou =\n    !authorFilteredParseResult.length && parseResult.length > 0;\n\n  const formattedBlameContext = convertBlameContextToExplain(repo);\n  return `base64: ${Buffer.from(\n    explainBlameTemplate(\n      args,\n      authorFilteredParseResultString,\n      formattedBlameContext,\n      repo.provider,\n      isNoUserButYou\n    )\n  ).toString('base64')}`;\n};\n\nexport enum HighLevelFilters {\n  allDocs = 'allDocs',\n  allImages = 'allImages',\n  allTests = 'allTests',\n  estimatedReviewTime = 'estimatedReviewTime',\n  extensions = 'extensions',\n  isFormattingChange = 'isFormattingChange',\n  matchDiffLines = 'matchDiffLines',\n  isFirstCommit = 'isFirstCommit',\n  rankByGitBlame = 'rankByGitBlame',\n  rankByGitActivity = 'rankByGitActivity',\n  explainRankByGitBlame = 'explainRankByGitBlame',\n  expertReviewer = 'expertReviewer',\n  explainExpertReviewer = 'explainExpertReviewer',\n  codeExperts = 'codeExperts',\n  explainCodeExperts = 'explainCodeExperts',\n  sonarParser = 'sonarParser',\n  mapToEnum = 'mapToEnum',\n  extractSonarFindings = 'extractSonarFindings',\n  extractJitFindings = 'extractJitFindings',\n}\n\nconst FILTERED_OUT_LIST = {\n  [HighLevelFilters.allDocs]: ['requirements.txt'],\n};\n\nexport const FILTERS_EXTENSION_LIST = {\n  [HighLevelFilters.allDocs]: ['md', 'mkdown', 'txt', 'rst', '.adoc'],\n  [HighLevelFilters.allImages]: ['svg', 'png', 'gif'],\n  [HighLevelFilters.allTests]: ['test', 'spec'],\n};\n\nexport const HIGH_LEVEL_FILTERS_HANDLER: any = {\n  [HighLevelFilters.allDocs]: (files: string[]) => {\n    handleAnalytics(HighLevelFilters.allDocs, []);\n    return (\n      Boolean(files.length) &&\n      files.every((file) =>\n        FILTERED_OUT_LIST[HighLevelFilters.allDocs].every(\n          (excludedFile) =>\n            !(file.includes('/' + excludedFile) || file === excludedFile)\n        )\n      ) &&\n      parseFilterAllExtensions(\n        files,\n        FILTERS_EXTENSION_LIST[HighLevelFilters.allDocs]\n      )\n    );\n  },\n  [HighLevelFilters.allImages]: (files: string[]) => {\n    handleAnalytics(HighLevelFilters.allImages, []);\n    return parseFilterAllExtensions(\n      files,\n      FILTERS_EXTENSION_LIST[HighLevelFilters.allImages]\n    );\n  },\n  [HighLevelFilters.allTests]: (files: string[]) => {\n    handleAnalytics(HighLevelFilters.allTests, []);\n    return parseFilterAllTests(\n      files,\n      FILTERS_EXTENSION_LIST[HighLevelFilters.allTests]\n    );\n  },\n  [HighLevelFilters.estimatedReviewTime]: estimatedReviewTime,\n  [HighLevelFilters.extensions]: getUniqueExtensions,\n  [HighLevelFilters.isFormattingChange]: parseIsFormattingChange,\n  [HighLevelFilters.matchDiffLines]: parseMatchDiffLines,\n  [HighLevelFilters.isFirstCommit]: parseIsFirstCommit,\n  [HighLevelFilters.rankByGitBlame]: parseRankByGitBlame,\n  [HighLevelFilters.rankByGitActivity]: parseRankByGitActivity,\n  [HighLevelFilters.explainRankByGitBlame]: parseExplainRankByGitBlame,\n  [HighLevelFilters.expertReviewer]: parseExpertReviewer,\n  [HighLevelFilters.explainExpertReviewer]: parseExplainExpertReviewer,\n  [HighLevelFilters.codeExperts]: parseCodeExperts,\n  [HighLevelFilters.explainCodeExperts]: parseExplainCodeExperts,\n  [HighLevelFilters.sonarParser]: parseSonarParser,\n  [HighLevelFilters.mapToEnum]: parserMapToEnum,\n  [HighLevelFilters.extractSonarFindings]: parseExtractSonarFindings,\n  ...jitFilter,\n};\n\nexport const ASYNC: any = {\n  [HighLevelFilters.estimatedReviewTime]: true,\n  [HighLevelFilters.expertReviewer]: true,\n  [HighLevelFilters.explainExpertReviewer]: true,\n  [HighLevelFilters.codeExperts]: true,\n  [HighLevelFilters.explainCodeExperts]: true,\n};\n","import prettier from 'prettier';\nimport { File } from '../context/types';\n\nconst parseFilterAllFilePath = (files: string[], searchArray: string[]) => {\n  return (\n    files.length &&\n    files\n      .map((filePath: string) =>\n        searchArray.some((term: string) => (filePath || '').includes(term))\n      )\n      .every((x: boolean) => x === true)\n  );\n};\n\nconst parseIsEveryExtension = (files: string[], extensions: string[]) => {\n  return parseFilterAllFilePath(\n    files\n      .map((filePath: string) => filePath.split('.').pop() || '')\n      .filter((value, index, array) => array.indexOf(value) === index),\n    extensions\n  );\n};\n\nconst parseIsEveryExtensionRegex = (files: string[], filter: string) => {\n  const re = new RegExp(filter);\n  const extensions = files\n    .map((filePath: string) => filePath.split('.').pop() || '')\n    .filter((value, index, array) => array.indexOf(value) === index);\n\n  return (\n    extensions.length > 0 &&\n    extensions\n      .map((filePath: string) => re.test(filePath))\n      .every((match: any) => match)\n  );\n};\n\nconst parseExtractExtensions = (files: string[]) =>\n  files.length &&\n  files\n    // extensions\n    .map((x: string) => x.split('.').pop())\n    // unique\n    .filter((value, index, array) => array.indexOf(value) === index);\n\nconst parseIsStringIncludes = (file: string, terms: string[]) =>\n  terms.some((term: any) => file.includes(term));\n\nconst parseIsStringIncludesRegex = (file: string, filter: string) => {\n  const re = new RegExp(filter);\n  return re.test(file);\n};\n\nconst parseRegex = (files: string[], filter: string) => {\n  const re = new RegExp(filter);\n  return files.length\n    ? files.map((file: any) => re.test(file)).every((match: any) => match)\n    : false;\n};\n\nconst parseIsEveryInListRegex = (files: string[], filter: string) => {\n  const re = new RegExp(filter);\n  return files.length\n    ? files.map((file: any) => re.test(file)).every((match: any) => match)\n    : false;\n};\n\nconst parseIsEveryInList = (files: string[], filters: string[]) => {\n  return files.length\n    ? files\n        .filter((file: any) => filters.includes(file))\n        .every((match: any) => match)\n    : false;\n};\n\nconst parseIsSomeInList = (files: string[], searchTerms: string[]) => {\n  return files.length\n    ? files\n        .filter((file: any) => searchTerms.includes(file))\n        .some((match: any) => match)\n    : false;\n};\n\nconst parseIncludesRegex = (files: string[], filter: string) => {\n  const re = new RegExp(filter);\n  return files.length\n    ? files.map((file: any) => re.test(file)).some((match: any) => match)\n    : false;\n};\n\nconst parseIsSomeInListRegex = (files: string[], filter: string) => {\n  const re = new RegExp(filter);\n  return files.length\n    ? files.map((file: any) => re.test(file)).some((match: any) => match)\n    : false;\n};\n\nconst parseFilterRegex = (files: string[], filter: string) => {\n  const re = new RegExp(filter);\n  return files.length ? files.filter((file: any) => re.test(file)) : false;\n};\n\nconst parseFilterListRegex = (files: string[], filter: string) => {\n  const re = new RegExp(filter);\n  return files.length ? files.filter((file: any) => re.test(file)) : false;\n};\n\nconst parseFilterList = (files: string[], filters: string[]) => {\n  return files.length\n    ? files.filter((file: any) => filters.includes(file))\n    : false;\n};\n\nconst minify = (text: string) =>\n  text.replace(/\\s+/g, ' ').replaceAll(\"'\", '\"').trim();\n\nconst allFormattingChange = (files: File[]) => {\n  try {\n    const allFormatting = files.every(\n      ({ new_content, original_content, original_file, new_file }) => {\n        const formattedNew = prettier.format(new_content, {\n          semi: false,\n          singleQuote: true,\n          filepath: new_file,\n        });\n        const formattedOld = prettier.format(original_content, {\n          semi: false,\n          singleQuote: true,\n          filepath: original_file,\n        });\n        return minify(formattedNew) === minify(formattedOld);\n      }\n    );\n    return allFormatting;\n  } catch (e) {\n    return false;\n  }\n};\n\nconst parseFilterFileDiffRegex = (files: File[], filterRegex: string) => {\n  const re = new RegExp(filterRegex, 'm');\n  return files.length ? files.filter(({ diff }) => re.test(diff)) : false;\n};\n\nconst parseIsEveryLineInFileDiffRegex = (\n  files: File[],\n  filterRegex: string\n) => {\n  const re = new RegExp(filterRegex, 'm');\n  return files.length\n    ? files.map(({ diff }) => re.test(diff)).every((match: any) => match)\n    : false;\n};\n\nconst parseIsSomeLineInFileDiffRegex = (files: File[], filterRegex: string) => {\n  const re = new RegExp(filterRegex, 'm');\n  return files.length\n    ? files.map(({ diff }) => re.test(diff)).some((match: any) => match)\n    : false;\n};\n\nconst parseFilterAllExtensions = (files: string[], extensions: string[]) => {\n  return files.length\n    ? parseFilterAllFilePath(\n        files.map((filePath: string) => filePath.split('.').pop() || ''),\n        extensions\n      )\n    : false;\n};\n\nexport enum Filters {\n  allExtensions = 'allExtensions',\n  includes = 'includes',\n  allPassRegex = 'allPassRegex',\n  allPathIncludes = 'allPathIncludes',\n  filterRegex = 'filterRegex',\n  includesRegex = 'includesRegex',\n  true = 'true',\n  allFormattingChange = 'allFormattingChange',\n  filterList = 'filterList',\n  filterListRegex = 'filterListRegex',\n  isEveryInListRegex = 'isEveryInListRegex',\n  isSomeInList = 'isSomeInList',\n  isSomeInListRegex = 'isSomeInListRegex',\n  isStringIncludes = 'isStringIncludes',\n  isStringIncludesRegex = 'isStringIncludesRegex',\n  isEveryInList = 'isEveryInList',\n  extractExtensions = 'extractExtensions',\n  isEveryExtension = 'isEveryExtension',\n  isEveryExtensionRegex = 'isEveryExtensionRegex',\n  filterFileDiffRegex = 'filterFileDiffRegex',\n  isEveryLineInFileDiffRegex = 'isEveryLineInFileDiffRegex',\n  isSomeLineInFileDiffRegex = 'isSomeLineInFileDiffRegex',\n}\n\nexport const FILTER_HANDLERS: any = {\n  [Filters.filterList]: parseFilterList,\n  [Filters.filterListRegex]: parseFilterListRegex,\n  [Filters.isEveryInListRegex]: parseIsEveryInListRegex,\n  [Filters.isSomeInList]: parseIsSomeInList,\n  [Filters.isSomeInListRegex]: parseIsSomeInListRegex,\n  [Filters.isStringIncludes]: parseIsStringIncludes,\n  [Filters.isStringIncludesRegex]: parseIsStringIncludesRegex,\n  [Filters.isEveryInList]: parseIsEveryInList,\n  [Filters.extractExtensions]: parseExtractExtensions,\n  [Filters.isEveryExtension]: parseIsEveryExtension,\n  [Filters.isEveryExtensionRegex]: parseIsEveryExtensionRegex,\n  [Filters.true]: () => true,\n  [Filters.filterFileDiffRegex]: parseFilterFileDiffRegex,\n  [Filters.isEveryLineInFileDiffRegex]: parseIsEveryLineInFileDiffRegex,\n  [Filters.isSomeLineInFileDiffRegex]: parseIsSomeLineInFileDiffRegex,\n  //TODO: remove soon - those filters are deprecated!\n  [Filters.allExtensions]: parseFilterAllExtensions,\n  [Filters.allPassRegex]: parseRegex,\n  [Filters.allPathIncludes]: parseFilterAllFilePath,\n  [Filters.filterRegex]: parseFilterRegex,\n  [Filters.includesRegex]: parseIncludesRegex,\n  [Filters.allFormattingChange]: allFormattingChange,\n};\n","export enum DefaultParserAttributes {\n  cbLeft = '_GITSTREAM_CB_LEFT_',\n  cbRight = '_GITSTREAM_CB_RIGHT_',\n  automations = 'automations',\n  errors = 'errors',\n  analytics = 'analytics',\n}\n\nexport type Run = { action: string; args?: any };\n","import * as yaml from 'js-yaml';\nimport * as nunjucks from 'nunjucks';\nimport { ERRORS, STATUS_CODES } from '../consts';\nimport { listify } from './args.definitions';\nimport { Context } from './context/types';\nimport { GENERAL_FILTERS_HANDLER } from './filters/general-filters';\nimport {\n  ASYNC,\n  HIGH_LEVEL_FILTERS_HANDLER,\n} from './filters/high-level-filters';\nimport { FILTER_HANDLERS } from './old-filters/filters';\nimport { DefaultParserAttributes, Run } from './types';\nimport { FiltersForAnalytics } from './filters/common';\n\nexport default class RuleParser {\n  private env: nunjucks.Environment;\n  private renderedRuleFile: any = {};\n  private context: Context | {} = {};\n  private ruleFileRawContent: string;\n  private lastParserResult: any = {};\n  private isDebug: boolean | string;\n\n  constructor(\n    ruleFileContent: string,\n    context: Context,\n    debugMode: boolean | string\n  ) {\n    this.isDebug = debugMode;\n    this.env = new nunjucks.Environment(\n      new nunjucks.FileSystemLoader(__dirname),\n      { autoescape: false }\n    );\n\n    const allFilters: any = {\n      ...GENERAL_FILTERS_HANDLER,\n      ...HIGH_LEVEL_FILTERS_HANDLER,\n      ...FILTER_HANDLERS,\n    };\n\n    Object.keys(allFilters).forEach((filter: any) => {\n      this.env.addFilter(filter, allFilters[filter], ASYNC[filter]);\n    });\n\n    this.context = context;\n    this.ruleFileRawContent = ruleFileContent;\n    if (this.isDebug) {\n      console.log({\n        context: JSON.stringify(this.context, null, 2),\n        ruleFile: ruleFileContent,\n      });\n    }\n  }\n\n  private async render(\n    context = { ...this.context, ...this.renderedRuleFile }\n  ) {\n    let reRenders = 3;\n    let currentContext = context;\n    while (reRenders) {\n      const dataAsString = this.ruleFileRawContent;\n      await new Promise((resolve, reject) =>\n        this.env.renderString(dataAsString, currentContext, (err, res) => {\n          if (err) {\n            if (this.isDebug) {\n              console.log(ERRORS.FAILED_RENDER_STRING, err);\n            }\n            reject(err);\n            return;\n          }\n          try {\n            this.renderedRuleFile = yaml.load(res!);\n          } catch (error) {\n            if (this.isDebug) {\n              console.log(ERRORS.FAILED_YAML_LOAD, error);\n            }\n            this.renderedRuleFile = {\n              ...this.renderedRuleFile,\n              errors: {\n                [STATUS_CODES.FAILED_YAML_LOAD]: ERRORS.FAILED_YAML_LOAD,\n              },\n            };\n          }\n          resolve(this);\n        })\n      );\n      reRenders -= 1;\n      currentContext = { ...this.context, ...this.renderedRuleFile };\n    }\n  }\n\n  private validateRun(runs: Run[]) {\n    if (!runs) {\n      return runs;\n    }\n    return runs.map((run) => {\n      if (!run.args) {\n        return run;\n      }\n      const newArgs = Object.keys(run.args).reduce((acc: any, arg: string) => {\n        const argValue = run.args[arg];\n        return {\n          ...acc,\n          [arg]:\n            argValue && listify.includes(arg) && typeof argValue === 'string'\n              ? argValue.split(',')\n              : run.args[arg],\n        };\n      }, {});\n      return { ...run, args: newArgs };\n    });\n  }\n\n  private combineMetadataWithRulesResult(resourceName: string) {\n    if (!this.renderedRuleFile[resourceName]) {\n      return {};\n    }\n    return Object.keys(this.renderedRuleFile[resourceName]).reduce(\n      (acc, resource) => {\n        const rules: any = this.renderedRuleFile[resourceName][resource].if.map(\n          (result: any) => {\n            return {\n              passed: result,\n            };\n          }\n        );\n        const passed = rules\n          .map(({ passed }: { passed: any }) => passed)\n          .every((pass: any) =>\n            typeof pass === 'object' ? !!Object.keys(pass || {}).length : !!pass\n          );\n        return {\n          ...acc,\n          [resource]: {\n            if: rules,\n            run: this.validateRun(\n              this.renderedRuleFile[resourceName][resource].run\n            ),\n            passed,\n          },\n        };\n      },\n      {}\n    );\n  }\n\n  private combineMetadataWithResult() {\n    this.lastParserResult = {\n      [DefaultParserAttributes.errors]: {\n        ...(this.renderedRuleFile[DefaultParserAttributes.errors] &&\n          this.renderedRuleFile[DefaultParserAttributes.errors]),\n      },\n      [DefaultParserAttributes.automations]: {\n        ...this.combineMetadataWithRulesResult(\n          DefaultParserAttributes.automations\n        ),\n      },\n      [DefaultParserAttributes.analytics]: {\n        ...(Object.keys(FiltersForAnalytics.filters).length &&\n          FiltersForAnalytics.filters),\n      },\n    };\n    return this.lastParserResult;\n  }\n\n  async parseStreams() {\n    await this.render();\n    return this.combineMetadataWithResult();\n  }\n}\n"],"names":["BASE_URL","API_ENDPOINTS","REVIEW_TIME","EXPERT_REVIWER","PACKAGE_NAME","ERRORS","FAILED_RENDER_STRING","FAILED_YAML_LOAD","STATUS_CODES","argsDefinitionsByAction","comment","name","type","label","labels","reviewers","team_reviewers","wait_for_all_checks","rebase_on_merge","squash_on_merge","approvals","listify","internalIncludes","file","searchTerm","includes","internalRegex","multiline","startsWith","substring","slice","replace","re","RegExp","test","internalEvery","arr","value","bools","map","item","Boolean","length","every","element","formatInputToList","input","split","PROVIDER","GITHUB","GITLAB","BITBUCKET","PROVIDER_NAME","DOCS_LINK_COMMENT","MONTH","FiltersForAnalytics","handleAnalytics","filterName","filterArgs","filters","args","parseSome","list","GeneralFilters","some","formattedList","match","parseEvery","termRegexOrList","attribute","term","regex","search","filterList","files","isReject","filter","mapList","calculateList","callbackName","attr","formattedFiles","parseFilter","parseReject","reject","parseMap","parseIncludes","parseMatch","parseNope","GENERAL_FILTERS_HANDLER","nope","ADDITIONAL_FORMATTING","github","gitlab","calculateSumByAuthor","authorMetric","author","Object","values","reduce","aa","precent","totalPercent","convertAndSumContributors","contributors","gitToProviderUser","keys","acc","gitAuthor","score","convertContributorsAndBlame","repo","blame","git_to_provider_user","sumAuthorMetrics","numOfFiles","sumByAuthor","calculateActivityPerFile","activity","weeksArr","totalPerFile","ac","linesPerWeek","forEach","week","calculateFileSumPerAuthorActivity","totalsPerFile","calcPercent","acAuthor","arrSum","push","total","a","b","parseInt","toFixed","sortObject","data","object","sort","compareThan","gt","lt","authors","undefined","sortedAuthors","validateAndCompare","authorMetrics","convertBlameContextToExplain","formattedValues","accAuthor","formatGitAuthor","formattedValue","Math","floor","suggestedReviewersComment","authorFilteredParseResult","argsTemplate","numOfPRFiles","isNoUserButYou","formattedComment","explainBlameTemplate","formattedBlameContext","provider","parserResultTemplate","isGitUser","x","result","isGtLtArgsValid","getETR","request","axios","post","headers","numericValue","getExpertReviewer","filterExpertResult","filterBy","thresholdData","user","contributor","parseExpertReviewerThreshold","getAndFilterExpertReviewer","data_service","expert_reviwer_request","dataWithoutIssuer","isIssuerFiltered","pr_author","explainExpertReviewerComment","expertReviewers","activeUsers","knowledgeUsers","threshold","join","explainActivityByMonth","activityUsers","monthsComment","months","index","moment","subtract","format","month","user1Value","user2Value","additions","deletions","explainActivityTable","table","explainKnowledgeSection","knowledge","knowledgeText","explainActivityAndBlameComment","error","console","log","parseActivityByUserDataForExplain","date","formatedDate","parseActivityByUserForExplain","au","activityData","getExplainActivity","userActivity","getExplainKnowledge","userKnowledge","round","DELETED_PATH","estimatedReviewTime","branch","callback","HighLevelFilters","diff","files_metadata","additionalLines","deletedLines","prFiles","fileMetadata","file_path","new_file","original_file","reqBody","prMetadata","commits","num_of_commits","lines","prAdditionalLines","prDeletedLines","baseBranch","base","request_source","parseExpertReviewer","expertReviewer","parseExplainCodeExpertHandler","explainActivity","explain","explainKnowledge","explainComment","Array","from","Set","base64Comment","Buffer","toString","parseCodeExperts","codeExperts","parseExplainExpertReviewer","explainExpertReviewer","parseExplainCodeExperts","explainCodeExperts","PYTHON_COMMAND","minify","text","replaceAll","trim","removeEmptyLines","jsFormatter","content","prettier","semi","singleQuote","filepath","pyFormatter","blackResult","spawnSync","JSON","stringify","formattedCode","stdout","SUPPORTED_FORMATTERS","js","ts","html","py","fileExtension","pop","formatter","_","get","SONAR_REGEX","BUGS","VULNERABILITIES","SECURITY_HOTSPOTS","CODE_SMELL","DUPLICATIONS","COVERAGE","RATING","getSonarPropertyRating","str","rawRating","rating","lastIndexOf","indexOf","getSonarPropertyCount","row","isFloat","count","parseFloat","isNaN","parseSonarParser","pr","sonarParser","sonarObject","bugs","code_smells","vulnerabilities","security_hotspots","duplications","coverage","sonarComment","comments","commenter","sonarCommentArray","JIT_USER","parseJitReview","review","parsedReview","initEmptyJitObject","conversations","conversation","security_control","description","severity","_summary","summary","metrics","unifyReviews","parsedReviews","jitObject","mergeWith","extractJitCommentsFromPR","reviews","HIGH","MEDIUM","LOW","INFO","parseJitComments","extractJitFindings","jitComments","isEmpty","parseExtractSonarFindings","extractSonarFindings","parserMapToEnum","key","mapToEnum","enumArgs","parseFilterAllTests","extensions","filePath","parseFilterAllFilePath","searchArray","parseFilterAllExtensions","getUniqueExtensions","array","parseIsFormattingChange","isFormattingChange","allFormatting","new_content","original_content","formattedNew","formattedOld","e","parseMatchDiffLines","matchDiffLines","ignoreWhiteSpaces","diffLinesRegex","emptyLinesRegex","diffRow","flat","parseIsFirstCommit","isFirstCommit","parseRankByGitBlame","rankByGitBlame","blameByAuthor","comparedResult","parseRankByGitActivity","rankByGitActivity","weeks","fill","i","git_activity","fileSumPerAuthor","activityByAuthor","convertContributors","parseExplainRankByGitBlame","explainRankByGitBlame","parseResult","authorFilteredParseResultString","FILTERED_OUT_LIST","allDocs","FILTERS_EXTENSION_LIST","allImages","allTests","HIGH_LEVEL_FILTERS_HANDLER","excludedFile","jitFilter","ASYNC","parseIsEveryExtension","parseIsEveryExtensionRegex","parseExtractExtensions","parseIsStringIncludes","terms","parseIsStringIncludesRegex","parseRegex","parseIsEveryInListRegex","parseIsEveryInList","parseIsSomeInList","searchTerms","parseIncludesRegex","parseIsSomeInListRegex","parseFilterRegex","parseFilterListRegex","parseFilterList","allFormattingChange","parseFilterFileDiffRegex","filterRegex","parseIsEveryLineInFileDiffRegex","parseIsSomeLineInFileDiffRegex","Filters","FILTER_HANDLERS","filterListRegex","isEveryInListRegex","isSomeInList","isSomeInListRegex","isStringIncludes","isStringIncludesRegex","isEveryInList","extractExtensions","isEveryExtension","isEveryExtensionRegex","filterFileDiffRegex","isEveryLineInFileDiffRegex","isSomeLineInFileDiffRegex","allExtensions","allPassRegex","allPathIncludes","includesRegex","DefaultParserAttributes","RuleParser","ruleFileContent","context","debugMode","isDebug","env","nunjucks","__dirname","autoescape","allFilters","addFilter","ruleFileRawContent","ruleFile","render","renderedRuleFile","reRenders","currentContext","dataAsString","Promise","resolve","renderString","err","res","yaml","errors","validateRun","runs","run","newArgs","arg","argValue","combineMetadataWithRulesResult","resourceName","resource","rules","passed","pass","combineMetadataWithResult","lastParserResult","automations","analytics","parseStreams"],"mappings":"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"}